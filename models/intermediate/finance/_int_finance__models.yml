version: 2

models:
  - name: int_fincance__revenue
    description: >
      This model calculates the total revenue per night for hotel bookings by joining the payment, booking, and agent data. 
      The model is materialized incrementally and updates with new records based on the `datetimeload_utc` field.
    config:
      materialized: incremental
      unique_key: payment_id
    columns:
      - name: payment_id
        description: Unique identifier for each payment made.
        tests:
          - not_null
          - unique
      - name: hotel_id
        description: Identifier for the hotel where the booking was made.
        tests:
          - not_null
      - name: room_id
        description: Identifier for the room associated with the booking.
        tests:
          - not_null
      - name: price_per_night
        description: >
          Price per night calculated from the base price of the hotel and the difference in days between check-in and check-out.
        tests:
          - not_null
          - positive_values
      - name: total_revenue_euros
        description: >
          Total revenue generated by the agent based on the final booking price and the commission rate.
        tests:
          - not_null
          - positive_values
